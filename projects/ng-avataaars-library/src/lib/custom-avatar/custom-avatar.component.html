<div class="kip-xl-container container-fluid mx-auto p-3">
  <div class="row">
    <div class="card p-2 w-100">
      <div class="row">
        <div class="col-sm-4 p-2" style="text-align:center">
          <kip-custom-avatar-base [widthFull]="true" viewBox="0 0 264 280" [attr.id]="id" [graphicType]="graphicType"
            [clotheColor]="clotheColor" [backgroundColor]="backgroundColor" [avatarStyle]="avatarStyle"
            [clotheType]="clotheType" [mouthType]="mouthType" [eyeType]="eyeType" [eyebrowType]="eyebrowType"
            [skinColor]="skinColor" [topType]="topType" [hairColor]="hairColor" [facialHairType]="facialHairType"
            [facialHairColor]="facialHairColor" [eyebrowColor]="eyebrowColor" [petType]="petType"
            [awardType]="awardType" [hatColor]="hatColor" [accessoriesType]="accessoriesType"
            [accessoriesColor]="accessoriesColor" [clotheColor2]="clotheColor2" [clotheColor3]="clotheColor3"
            [noPet]="noPet" [noAward]="noAward" [noseType]="noseType" [earringType]="earringType"
            [earringColor]="earringColor">
          </kip-custom-avatar-base>
          <textarea [id]="svgId" style="display:none">{{ svg }}</textarea>
        </div>
        <div class="col-sm-8 p-2">
          <ul class="nav nav-tabs">
            <li class="nav-item">
              <kip-custom-avatar-icon-background [index]="tabIndexes.background" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-background>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-top [index]="tabIndexes.top" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-top>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-eye [index]="tabIndexes.eyes" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-eye>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-eye-brow [index]="tabIndexes.eyebrows" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-eye-brow>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-accessories [index]="tabIndexes.accessory" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-accessories>
            </li>
            <li class="nav-item" *ngIf="!noEarring">
              <kip-custom-avatar-icon-ear-ring [index]="tabIndexes.earring" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-ear-ring>
            </li>
            <li class="nav-item" *ngIf="!noNose">
              <kip-custom-avatar-icon-nose [index]="tabIndexes.nose" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-nose>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-mouth [index]="tabIndexes.mouth" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-mouth>
            </li>
            <li class="nav-item" *ngIf="!noFacialHair">
              <kip-custom-avatar-icon-facial-hair [index]="tabIndexes.facialHair" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-facial-hair>
            </li>
            <li class="nav-item">
              <kip-custom-avatar-icon-clothes [index]="tabIndexes.clothes" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-clothes>
            </li>
            <li class="nav-item" *ngIf="!noPet">
              <kip-custom-avatar-icon-pet [index]="tabIndexes.pet" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-pet>
            </li>
            <li class="nav-item" *ngIf="!noAward">
              <kip-custom-avatar-icon-award [index]="tabIndexes.award" [currentIndex]="tabIndex"
                (selectTab)="tabIndex  = $any($event)">
              </kip-custom-avatar-icon-award>
            </li>
          </ul>
          <div class="card-body">
            <div class="row">
              <div class="tab-content col-12" [ngSwitch]="tabIndex">
                <div *ngSwitchCase="tabIndexes.background">
                  <kip-custom-avatar-picker *ngIf="!noColorBackground" [title]="avatarText.background"
                    [options]="avatarStyles" [currentOption]="avatarStyle" (optionPicked)="avatarStyle=$any($event)">
                    <ng-template let-item kipPickerTemplate="item">
                      <kip-custom-avatar-base [widthFull]="true" transform="scale(0.4) translate(-5,-33)"
                        viewBox="0 0 100 100" [noFeatures]="true" [avatarStyle]="item.value"
                        [backgroundColor]="backgroundColor" [skinColor]="skinColor">
                      </kip-custom-avatar-base>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker *ngIf="!noColorBackground" [title]="avatarText.backgroundColor"
                    [colors]="backgroundColors" [colorConverter]="backgroundColorConvert"
                    [currentColor]="backgroundColor" (colorPicked)="backgroundColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.skinColors" [colors]="skinColors"
                    [colorConverter]="skinColorConvert" [currentColor]="skinColor" (colorPicked)="skinColor=$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.eyebrows" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.eyebrows" [options]="eyebrowTypes"
                    [currentOption]="eyebrowType" (optionPicked)="eyebrowType =$any($event)"
                    [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 85 85">
                        <g transform="translate(-3,30) scale(0.8)" kip-custom-avatar-eye-brows
                          [eyebrowType]="item.value" [eyebrowColor]="eyebrowColor" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.eyebrowColors" [colors]="eyebrowColors"
                    [colorConverter]="hairColorConvert" [currentColor]="eyebrowColor"
                    (colorPicked)="eyebrowColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.accessory" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.accessories" [options]="accessoriesTypes"
                    [currentOption]="accessoriesType" (optionPicked)="accessoriesType =$any($event)"
                    [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(-35,0)" kip-custom-avatar-accessories [accessoriesType]="item.value"
                          [accessoriesColor]="accessoriesColor" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.accessoryColors" [colors]="accessoriesColors"
                    [colorConverter]="accessoriesColorConvert" [currentColor]="accessoriesColor"
                    (colorPicked)="accessoriesColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.earring" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.earrings" [options]="earringTypes"
                    [currentOption]="earringType" (optionPicked)="earringType =$any($event)"
                    [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(40,0)" kip-custom-avatar-ear-ring [earringType]="item.value"
                          [earringColor]="earringColor" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.earringColors" [colors]="earringColors"
                    [colorConverter]="earringColorConvert" [currentColor]="earringColor"
                    (colorPicked)="earringColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.facialHair" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.facialHairs" [options]="facialHairTypes"
                    [currentOption]="facialHairType" (optionPicked)="facialHairType =$any($event)"
                    [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(-40,-40)" kip-custom-avatar-facial-hair [facialHairType]="item.value"
                          [facialHairColor]="facialHairColor" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.facialHairColors" [colors]="eyebrowColors"
                    [colorConverter]="hairColorConvert" [currentColor]="facialHairColor"
                    (colorPicked)="facialHairColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.nose" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.noses" [options]="noseTypes" [currentOption]="noseType"
                    (optionPicked)="noseType =$any($event)" [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 100 100">
                        <g transform="translate(-5,0)" kip-custom-avatar-nose [noseType]="item.value" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.mouth" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.mouths" [options]="mouthTypes"
                    [currentOption]="mouthType" (optionPicked)="mouthType =$any($event)"
                    [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 100 100">
                        <g transform="translate(-5,-20)" kip-custom-avatar-mouth [mouthType]="item.value" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.eyes" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.eyes" [options]="eyeTypes" [currentOption]="eyeType"
                    (optionPicked)="eyeType =$any($event)" [backgroundColor]="skinColorConvert(skinColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 100 100">
                        <g transform="translate(-5,20)" kip-custom-avatar-eyes [eyeType]="item.value" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.pet" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.pets" [options]="petTypes" [currentOption]="petType"
                    (optionPicked)="petType =$any($event)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 100 100">
                        <g transform="scale(0.18) translate(20,20)" kip-custom-avatar-pet [petType]="item.value" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.award" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.awards" [options]="awardTypes"
                    [currentOption]="awardType" (optionPicked)="awardType =$any($event)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 100 100">
                        <g transform="scale(0.18) translate(20,20)" kip-custom-avatar-award [awardType]="item.value"
                          [skinColor]="skinColor" [clotheColor]="clotheColor" [clotheColor2]="clotheColor2" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.top" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.hatsAndHairStyles" [options]="topTypes"
                    [currentOption]="topType" (optionPicked)="topType =$any($event)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(-10,10) scale(0.9)" kip-custom-avatar-top [hairColor]="hairColor"
                          [hatColor]="hatColor" [topType]="item.value" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker *ngIf="!hatColorVisible" [title]="avatarText.hairColors"
                    [colors]="hairColors" [colorConverter]="hairColorConvert" [currentColor]="hairColor"
                    (colorPicked)="hairColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                  <kip-custom-avatar-color-picker *ngIf="hatColorVisible" [title]="avatarText.hatColors"
                    [colors]="hatColors" [colorConverter]="hatColorConvert" [currentColor]="hatColor"
                    (colorPicked)="hatColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                </div>
                <div *ngSwitchCase="tabIndexes.clothes" class="kip-avatar-pick-svg">
                  <kip-custom-avatar-picker [title]="avatarText.clothes" [options]="clotheTypes"
                    [currentOption]="clotheType" (optionPicked)="clotheType =$any($event)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(-32,-130)" kip-custom-avatar-clothes [clotheType]="item.value"
                          [clotheColor]="clotheColor" [clotheColor2]="clotheColor2" [clotheColor3]="clotheColor3"
                          [graphicType]="graphicType" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                  <kip-custom-avatar-color-picker [title]="avatarText.clotheColors1" [colors]="clotheColors"
                    [colorConverter]="clotheColorConvert" [currentColor]="clotheColor"
                    (colorPicked)="clotheColor =$any($event)">
                  </kip-custom-avatar-color-picker>
                  <kip-custom-avatar-color-picker *ngIf="clotheColor2Visible" [title]="avatarText.clotheColors2"
                    [colors]="clotheColors2" [colorConverter]="clotheColorConvert" [currentColor]="clotheColor2"
                    (colorPicked)="clotheColor2 =$any($event)">
                  </kip-custom-avatar-color-picker>
                  <kip-custom-avatar-color-picker *ngIf="clotheColor3Visible" [title]="avatarText.clotheColors3"
                    [colors]="clotheColors3" [colorConverter]="clotheColorConvert" [currentColor]="clotheColor3"
                    (colorPicked)="clotheColor3 =$any($event)">
                  </kip-custom-avatar-color-picker>
                  <kip-custom-avatar-picker *ngIf="clotheType == 'GraphicShirt'" [title]="avatarText.graphics"
                    [options]="graphicTypes" [currentOption]="graphicType" (optionPicked)="graphicType =$any($event)"
                    [backgroundColor]="clotheColorConvert(clotheColor)">
                    <ng-template let-item kipPickerTemplate="item">
                      <svg viewBox="0 0 200 200">
                        <g transform="translate(-30, 20)" kip-custom-avatar-graphics [graphicType]="item.value"
                          [clotheColor2]="clotheColor2" />
                      </svg>
                    </ng-template>
                  </kip-custom-avatar-picker>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="kip-footer fixed-bottom">
    <div class="kip-xl-container d-flex flex-row align-items-center justify-content-between mx-auto py-2 px-3">
      <div class="flex">
        <button *ngIf="!noSave" type="button" class="btn btn-primary mr-2" (click)="saveAvatar()"
          [disabled]='saveAvatarEnabled?null:true'>
          {{ avatarText.save }}
        </button>
        <button *ngIf="!noRandom" type="button" class="btn btn-secondary mr-2" (click)="randomAvatar()">
          {{ avatarText.random }}
        </button>
        <button *ngIf="!noSvgOutput" type="button" class="btn btn-secondary mr-2" (click)="selectSvg()">
          {{ avatarText.svg }}
        </button>
        <button *ngIf="!noSave" type="button" class="btn btn-secondary" (click)="revert()"
          [disabled]='saveAvatarEnabled?null:true'>
          {{ avatarText.revert }}
        </button>
      </div>
    </div>
  </div>
